## 트랜잭션(Transaction) ?

### 1) 개념

DB 시스템에서 하나의 논리적 기능을 정상적으로 수행하기 위한 작업의 기본 단위.

### 2) 특성

- 원자성(Atomicity) : 트랜잭션을 구성하는 연산 전체가 모두 정상적으로 실행되거나 취소 된다.
- 일관성(Consistency) : 시스템이 가지는 고정 요소는 트랜잭션 수행 전과 완료 후의 상태가 같다.
- 격리성(Isolation) : 동시에 실행되는 트랜잭션들은 서로 영향을 미치지 않는다.
- 영속성(Durability) : 성공이 완료된 트랜잭션의 결과는 영속적으로 DB에 저장된다.

### 3) 상태 변화

<p align="center">
<img src="images/트랜잭션의 상태 변화.png" width="400px" height="300px" title="px(픽셀) 크기 설정" alt="transaction status"><br/>
</p>

- 활성 : 트랜잭션 실행 중
- 부분 완료 : 마지막 명령문이 실행된 후
- 완료 : 트랜잭션이 성공적으로 완료된 후
- 실패 : 정상적인 실행이 더 이상 진행이 안되는 경우
- 철회 : 트랜잭션이 취소되고 트랜잭션이 시작 되기 전 상태로 환원

### 4) 제어

트랜잭션 제어언어를 TCL(Transaction Control Language)라고 한다.

명령어로는 COMMIT, ROLLBACK, CHECKPOINT가 있다.

| COMMIT | 트랜잭션 확정 | 트랜잭션을 메모리에 영구적으로 저장 |
| --- | --- | --- |
| ROLLBACK | 트랜잭션 취소 | 트랜잭션 내역을 저장 무효화 |
| CHECKPOINT | 저장 시기 설정 | ROLLBACK을 위한 시점 지정 |

### 5) 주요 기법

- **병행 제어(일관성)**

다수 사용자 환경에서 여러 트랜잭션을 수행할 때, DB 일관성 유지를 위해 상호 작용을 제어

*미보장 시 문제점*

갱신 손실 : 먼저 실행된 트랜잭션의 결과를 나중에 실행된 트랜잭션이 덮어쓰는 오류

현황 파악오류 : 트랜잭션의 중간 수행 결과를 다른 트랜잭션이 참조하는 오류

모순성 : 두 트랜잭션이 동시에 실행되어 DB의 일관성이 결여되는 오류

연쇄복귀

*종류 )*

로킹(Locking)

낙관적 검증

타임 스탬프 순서

다중버전 동시성 제어

- **고립화 수준(격리성)**

다른 트랜잭션이 현재의 데이터에 대한 무결성을 해치지 않기 위해 잠금을 설정하는 정도

*종류 )*

Read Uncommitted

Read Committed

Repeatable Read

Serializable Read

- **회복 기법(영속성)**

트랜잭션을 수행하는 도중 장애로 인해 손상된 DB를 손상되기 이전의 정상적인 상태로 복구시키는 작업

*종류 )*

REDO : 트랜잭션의 시작과 완료에 대한 기록이 있는 작업을 재작업

UNDO : 트랜잭션의 시작은 있지만, 완료 기록이 없는 트랜잭션들이 작업한 변경 내용들을 모두 취소

로그 기반, 체크 포인트, 그림자 페이징